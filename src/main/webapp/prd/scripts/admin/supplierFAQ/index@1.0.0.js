(function(e){var t={id:"27123400b253c3c5f055ec6aa7c997b7",filename:"content.string",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(e,t,n){if(typeof window.QTMPL==="undefined")window.QTMPL={};window.QTMPL["content"]='<div class="main">\n    <a class="g-btn qchat-download" href="//im.qunar.com/#/download" target="_blank">下载Qchat</a>\n    <div class="m-nav clearfix">\n        <div class="container">\n            <div class="m-nav-list">\n                <li>\n                    <a href="javascript:void(0)" @click="toWaiterManage">客服管理</a>\n                </li>\n                <li>\n                    <a href="javascript:void(0)" @click="toSmartConsult">智能客服选项</a>\n                </li>\n                <li class="active">\n                    <a href="javascript:void(0)">服务设置</a>\n                </li>\n            </div>\n        </div>\n    </div>\n    <div class="container">\n        <div class="m-sub-nav clearfix">\n            <div class="m-subnav-list">\n                <li v-for="item in suList" :class="{active: item.id === currentRobot.id}">\n                    <a href="javascript:;" @click="changeTab(item)">{{item.name}}</a>\n                </li>\n            </div>\n        </div>\n        <div class="m-form">\n            <div class="head">\n                <h3 class="title">设置智能客服欢迎语：</h3>\n            </div>\n            <div class="cont">\n                <div class="welcome-msg">\n                    <span class="label">欢迎语：</span>\n                    <input class="inp" type="text" v-model="currentRobot.robotWebcome" />\n                    <a href="javascript:;" class="g-btn g-btn-sm" @click="saveWelcomeMsg">保存</a>\n                </div>\n            </div>\n        </div>\n        <div class="m-form">\n            <div class="head">\n                <h3 class="title">设置常见问题：</h3>\n            </div>\n            <div class="cont">\n                <div class="m-faq">\n                    <p class="tips">只要您的产品线路里包含了您配置的目的地就会触发问答展示给用户，您也可以针对同一类问题输入多个目的地。</p>\n                    <div class="m-table">\n                        <div class="tr">\n                            <div class="th city">目的地</div>\n                            <div class="th question">问题</div>\n                            <div class="th answer">解答</div>\n                            <div class="th operate">\n                                <a href="javascript:;"  class="oper" @click="addFAQ">+新增问答集合</a>\n                            </div>\n                        </div>\n                        <div class="tr" v-for="(item, i) in FAQList">\n                            <div class="td city">\n                                <ul class="city-wrapper" @click="editFAQ(FAQList, i)">\n                                    <li class="item" v-for="(city, ii) in item.dest">\n                                        <span class="txt">{{city}}</span>\n                                    </li>\n                                </ul>\n                            </div>\n                            <div class="td question" @click="editFAQ(FAQList, i)">\n                                <input class="question-input"\n                                    v-for="question in item.question"\n                                    v-model="question"\n                                    placeholder="输入问题名称" />\n                            </div>\n                            <div class="td answer">\n                                <textarea class="question-input"\n                                    type="textarea"\n                                    :rows="4"\n                                    v-model="item.answer"\n                                    placeholder="录入问题的解答，支持去哪儿链接的录入"\n                                    @click="editFAQ(FAQList, i)"\n                                ></textarea>\n                            </div>\n                            <div class="td operate">\n                                <a href="javascript:;" class="oper" @click="delFAQ(i)">删除</a>\n                                <a href="javascript:;" class="oper" @click="editFAQ(FAQList, i, item.dest)">新增问答</a>\n                                <a href="javascript:;" class="oper" @click="operate(item, 1)" v-if="item.status === 0">启用</a>\n                                <a href="javascript:;" class="oper" @click="operate(item, 0)" v-if="item.status === 1">禁用</a>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n    <el-dialog\n        title="添加问答"\n        :visible.sync="dialog"\n        top="5vh"\n        width="40%"\n    >\n        <el-form :model="form" ref="form" :rules="formRules" label-width="130px">\n            <el-form-item label="出发地" v-if="form.type === \'routeFAQ\'" prop="dep">\n                <el-select\n                    v-model="form.dep"\n                    placeholder="请输入出发地"\n                    :remote-method="fetchSuggest"\n                    remote\n                    filterable\n                >\n                    <el-option\n                        v-for="item in suggestList"\n                        :key="item.id"\n                        :label="item.name"\n                        :value="item.name">\n                    </el-option>\n                </el-select>\n            </el-form-item>\n            <el-form-item label="目的地" prop="dest">\n                <el-select\n                    v-model="form.dest"\n                    multiple\n                    remote\n                    filterable\n                    placeholder="请输入出发地"\n                    :disabled="noEditDest"\n                    :remote-method="fetchSuggest"\n                >\n                    <el-option\n                        v-for="item in suggestList"\n                        :key="item.id"\n                        :label="item.name"\n                        :value="item.name">\n                    </el-option>\n                </el-select>\n            </el-form-item>\n            <el-form-item label="问题" prop="question">\n                <el-row>\n                    <el-col :span="20">\n                        <el-input v-model="form.question[0]" :maxlength="15" placeholder="问题名称不能超过15个字"></el-input>\n                    </el-col>\n                </el-row>\n            </el-form-item>\n            <el-form-item label="解答" prop="answer">\n                <el-input\n                    type="textarea"\n                    v-model="form.answer"\n                    :rows="4"\n                ></el-input>\n        </el-form>\n        <span slot="footer" class="dialog-footer">\n            <el-button @click="dialog = false">取 消</el-button>\n            <el-button type="primary" @click="submit">保存</el-button>\n        </span>\n    </el-dialog>\n</div>';if(typeof t!=="undefined")t.exports=window.QTMPL["content"]}(t.exports,t,e);e.____MODULES["27123400b253c3c5f055ec6aa7c997b7"]=t.exports})(this);(function(e){var t={id:"86d1e3b4840496091920cb12b77f0089",filename:"jquery.cookie.js",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(e,t,n){jQuery.cookie=function(e,t,n){if(arguments.length>1&&String(t)!=="[object Object]"){n=jQuery.extend({},n);if(t===null||t===undefined){n.expires=-1}if(typeof n.expires==="number"){var r=n.expires,i=n.expires=new Date;i.setDate(i.getDate()+r)}t=String(t);return document.cookie=[encodeURIComponent(e),"=",n.raw?escape(t):encodeURIComponent(t),n.expires?"; expires="+n.expires.toUTCString():"",n.path?"; path="+n.path:"",n.domain?"; domain="+n.domain:"",n.secure?"; secure":""].join("")}n=t||{};var s,o=n.raw?function(e){return unescape(e)}:decodeURIComponent;return(s=(new RegExp("(?:^|; )"+encodeURIComponent(e)+"=([^;]*)")).exec(document.cookie))?o(s[1]):null}}(t.exports,t,e);e.____MODULES["86d1e3b4840496091920cb12b77f0089"]=t.exports})(this);(function(e){var t={id:"02061ba61277a1df7ceca0753929967b",filename:"auto-height-client.js",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(e,t,n){(function(e,t){function a(e){if(u.test(e)){return RegExp.$1}else{return e}}function c(){if(e.document.documentElement.offsetHeight&&e.document.documentElement.scrollHeight&&$.browser.mozilla){return Math.min(e.document.documentElement.offsetHeight,e.document.documentElement.scrollHeight)}return Math.max(e.document.documentElement.offsetHeight,e.document.documentElement.scrollHeight)}var n={query:"auto",origin:"*",interval:"1000",id:"",url:""};var r=location.hash;var i,s;var o=e.autoheight=e.autoheight||{name:"autoheight"};o.config=o.config||{name:"config"};var u=/^([\w-]+:\/\/[^\/]+)/;var f=o.scroll=function(e,t){var n="id="+o.config.id+"&top="+e;if(typeof t!="undefined"){n+="&left="+t}o.config.origin=o.config.origin||a(o.config.url)||"*";s(n,o.config.origin)};var l=o.send=function(e){var n,r;if(typeof e=="number"){r=e;if(typeof arguments[1]=="number"){n=r;r=arguments[1]}}else if(typeof e=="object"){r="height"in e?e.height:"h"in e?e.h:"y"in e?e.y:t;n="width"in e?e.width:"w"in e?e.w:"x"in e?e.x:t}var s=[];s.push("id="+o.config.id);if(typeof n!=="undefined"){s.push("width="+n)}if(typeof r!=="undefined"){s.push("height="+r)}s.push("IFRAM_DATA="+window.IFRAM_DATA);o.config.origin=o.config.origin||a(o.config.url)||"*";i(s.join("&"),o.config.origin)};if(e.postMessage){i=function(t,r){clearInterval(i.itv);i.itv=setInterval(function(){e.parent.postMessage(t,r)},o.config.interval||n.interval)};s=function(t,n){e.parent.postMessage(t,n)}}else{$(function(){var t=0;var n=document.createElement("iframe");var r=n.id="_ifr_"+Math.random();var u=o.config.url;var a=o.config.interval;n.src="about:blank";n.style.display="none";e.document.body.appendChild(n);n=null;i=function(e,n){var i=document.getElementById(r);if(u!=o.config.url||a!=o.config.interval){u=o.config.url;a=o.config.interval}i.src=u+"?interval="+a+"&r="+t++%2+"#"+e};s=function(e,n){var i=document.getElementById(r);if(u!=o.config.url||a!=o.config.interval){u=o.config.url;a=0}i.src=u+"?interval="+a+"&r="+t++%2+"#"+e}})}var h;var p;$(function(){if(window!=top){h=setTimeout(function e(){if(o.config.id){var r=o.config.query||n.query;var i;if(typeof r=="function"){i=r();if(i===t){i=c()}}else if(r=="auto"){i=c()}else{i=r}if(p!==i){p=i;l(i)}if(parseInt(o.config.interval)!=0){h=setTimeout(e,o.config.interval||n.interval)}}else{h=setTimeout(e,13)}},50)}})})(this)}(t.exports,t,e);e.____MODULES["02061ba61277a1df7ceca0753929967b"]=t.exports})(this);(function(e){var t={id:"fc889a1e71c18b8357adeceada1618bf",filename:"iframeAutoHeight.js",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(t,n,r){e.____MODULES["86d1e3b4840496091920cb12b77f0089"];e.____MODULES["02061ba61277a1df7ceca0753929967b"];$(function(){var e="";if(/^http(s)?:\/\/.+$/.test($.cookie("QN52"))){e=$.cookie("QN52")}autoheight.config={id:"show_info",interval:"100",url:e+"/delegate.html",origin:"*",query:function(){}}})}(t.exports,t,e);e.____MODULES["fc889a1e71c18b8357adeceada1618bf"]=t.exports})(this);(function(e){var t={id:"9abc9e57e6c218fa30e3bd357194e8e4",filename:"index.esx",exports:{}};if(!e.____MODULES){e.____MODULES={}}var n=function(t,n,r){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function u(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++){n[t]=e[t]}return n}else{return Array.from(e)}}var i=e.____MODULES["27123400b253c3c5f055ec6aa7c997b7"];var s=o(i);e.____MODULES["fc889a1e71c18b8357adeceada1618bf"];var a={robotConfig:"/sys/saveRobotConfig.qunar",getQAList:"/sys/ml/supplier_robot/qalist.qunar",updateQAList:"/sys/ml/supplier_robot/update_qa.qunar"},f=window.suList[0]||{},l={supplier_id:f.id,business_id:window.bType};var c={};new Vue({el:"#pageManage",template:s.default,data:function(){return{noEditDest:false,operation:null,suggestList:[],suList:window.suList,currentRobot:f,dialog:false,form:{dest:[],question:[],answer:""},formRules:{dest:[{required:true,message:"请输入目的地",trigger:"blur,change"}],question:[{required:true,message:"问题不能为空",trigger:"blur,change"},{validator:function(t,n,r){var i=n[0];if(!i.replace(/^\s+|\s+$/g,"")){return r(new Error("问题不能为空"))}else if(!/[\u4E00-\u9FA5a-zA-Z0-9]/.test(i)){return r(new Error("问题不能全为标点符号"))}r()},trigger:"blur,change"}],answer:[{required:true,message:"请输入问题的解答",trigger:"blur,change"},{validator:function(t,n,r){if(!n.replace(/^\s+|\s+$/g,"")){return r(new Error("答案不能为空"))}else if(!/[\u4E00-\u9FA5a-zA-Z0-9]/.test(n)){return r(new Error("答案不能全为标点符号"))}else{var i=/(?:http(s)?:\/\/)?[\w.-]+(?:\.[\w\.-]+)+[\w\-\._~:/?#[\]@!\$&'\(\)\*\+,;=.]+/gm;var s=n.match(i);if(s&&s.length){var o=document.createElement("a");var u=s.some(function(e){return e.indexOf("test.com")===-1});if(u){return r(new Error("不可录入非test域名下的链接"))}}}r()}}]},FAQList:[]}},watch:{dialog:function(t){if(t===false){this.noEditDest=false}}},methods:{operate:function(t,n){$.ajax({url:a.updateQAList,type:"GET",dataType:"json",data:$.extend({},l,{id:t.id,status:n,answer:encodeURIComponent(t.answer),dest:t.dest.map(function(e){return encodeURIComponent(e)}).join(","),question:t.question.map(function(e){return encodeURIComponent(e)}).join(",")}),success:function(r){if(r.status===0){t.status=n}}})},submit:function(){var t=this;var n=this.form;var r=n.dest.sort().join(",");if(c[r]===10&&!n.id){this.$alert("该目的地下的问答已经到达最大数量10个，不能再增加问答");return}this.$refs.form.validate(function(e){if(e){$.ajax({url:a.updateQAList,type:"POST",dataType:"json",data:$.extend({},l,n.id?{id:n.id}:null,{answer:encodeURIComponent(n.answer),dest:n.dest.map(function(e){return encodeURIComponent(e)}).join(","),question:n.question.map(function(e){return encodeURIComponent(e)}).join(",")}),success:function(r){t.dialog=false;if(!n.id){t.getFAQList()}else{var i=t.operation,s=i.data,o=i.index;s[o]=$.extend(true,{},n)}}})}})},addFAQ:function(){var t=this;this.form={dest:[],question:[],answer:""};this.dialog=true;this.$nextTick(function(){t.$refs.form.clearValidate()})},editFAQ:function(t,n,r){var i=this;this.operation={data:t,index:n};this.form=r?{dest:[].concat(u(r)),question:[],answer:""}:$.extend(true,{},t[n]);if(r){var s=r.sort().join(",");if(c[s]===10){this.$alert("该目的地下的问答已经到达最大数量10个，不能再增加问答");return}this.noEditDest=true}this.dialog=true;this.$nextTick(function(){i.$refs.form.clearValidate()})},delFAQ:function(t){var n=this;var r=this.FAQList[t];$.ajax({url:a.updateQAList,type:"POST",dataType:"json",data:$.extend({},l,{status:2,id:r.id,answer:encodeURIComponent(r.answer),dest:r.dest.map(function(e){return encodeURIComponent(e)}).join(","),question:r.question.map(function(e){return encodeURIComponent(e)}).join(",")})}).done(function(e){if(e&&e.status===0){n.FAQList.splice(t,1);var i=r.dest.sort().join(",");--c[i]}})},fetchSuggest:function(t){var n=this;if(!t){this.suggestList=[];return}$.ajax({url:"//sgt.package.test.com/suggest/sight/sgt",type:"GET",dataType:"jsonp",data:{type:"城市,国家",start:0,rows:20,query:t},success:function(t){if(t&&t.ret&&t.data){n.suggestList=t.data}else{n.suggestList=[]}}})},saveWelcomeMsg:function(){var t=this;$.ajax({url:a.robotConfig,type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify({robotname:this.currentRobot.robotName,supplierid:this.currentRobot.id,robotstrategy:1,robotwelcome:this.currentRobot.robotWebcome})}).done(function(e){if(e&&e.ret){t.$alert("保存成功")}else{t.$alert("保存失败")}})},getFAQList:function(){var t=this;$.ajax({url:a.getQAList,type:"GET",dataType:"json",data:l}).done(function(e){if(e&&e.status===0&&e.data&&e.data.length){t.FAQList=e.data.filter(function(e){return e.status!==2}).map(function(e){e.dest=e.dest&&e.dest.split(",")||[];return e});c={};t.FAQList.forEach(function(e){var t=e.dest.sort().join(",");if(!c[t]){c[t]=1}else{++c[t]}})}else{t.FAQList=[]}})},changeTab:function(t){this.currentRobot=t;this.welcomeMsg=t.robotWebcome;l.supplier_id=t.id;this.getFAQList()},toWaiterManage:function(){var t=document.cookie.match(/(^|\s)QChat_bType=([^;]*)(;|$)/i),n=document.cookie.match(/(^|\s)QChat_bSuId=([^;]*)(;|$)/i),r,i;if(t&&t.length&&t[2].replace(/"/g,"")){r=t[2]}if(n&&n.length&&n[2].replace(/"/g,"")){i=n[2]}if(r&&i){document.location.href="/sys/manage.do?bType="+r+"&bSuId="+i}else if(r&&!i){document.location.href="/sys/manage.do?bType="+r}else if(!r&&i){document.location.href="/sys/manage.do?bSuId="+i}else{document.location.href="/sys/manage.do"}},toWechat:function(){location.href="/sys/wechat.qunar?bType="+window.bType},toSmartConsult:function(){location.href="/sys/smartConsult.do?bType="+window.bType}},mounted:function(){this.getFAQList()}})}(t.exports,t,e);e.____MODULES["9abc9e57e6c218fa30e3bd357194e8e4"]=t.exports})(this)